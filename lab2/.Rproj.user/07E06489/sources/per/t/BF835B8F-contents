# –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞ 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µc–∫–∏—Ö –≥–∏–ø–æ—Ç–µ–∑. 
# –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–∞—è –ª–∏–Ω–µ–π–Ω–∞—è —Ä–µ–≥—Ä–µ—Å—Å–∏—è

# ------------------------------------------------------------------------------

# –°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–æ–π –≥–∏–ø–æ—Ç–µ–∑–æ–π –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–µ–¥–ø–æ–ª–æ–∂–µ–Ω–∏–µ –æ –∫–∞–∫–∏—Ö-–ª–∏–±–æ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞—Ö —Å–ª—É—á–∞–π–Ω–æ–π –≤–µ–ª–∏—á–∏–Ω—ã.

# –ß–∞—â–µ –≤—Å–µ–≥–æ —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞—é—Ç—Å—è –≥–∏–ø–æ—Ç–µ–∑—ã
# 1) –æ –≤–∏–¥–µ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Å–ª—É—á–∞–π–Ω–æ–π –≤–µ–ª–∏—á–∏–Ω—ã,
# 2) –æ —á–∏—Å–ª–æ–≤—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–∞—Ö –∏–∑–≤–µ—Å—Ç–Ω—ã—Ö —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–π —Å–ª—É—á–∞–π–Ω–æ–π –≤–µ–ª–∏—á–∏–Ω—ã

# –ì–∏–ø–æ—Ç–µ–∑–∞ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–æ—Å—Ç–æ–π, –µ—Å–ª–∏ –æ–Ω–∞ –æ–¥–Ω–æ–∑–Ω–∞—á–Ω–æ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ 
# –≤—ã–±–æ—Ä–∫–∏: H = {F = F0}, –∏–Ω–∞—á–µ H –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è —Å–ª–æ–∂–Ω–æ–π.

# –ï—Å–ª–∏ –Ω–∞–º –∏–∑–≤–µ—Å—Ç–Ω—ã –≤—Å–µ –¥–∞–Ω–Ω—ã–µ, —Ç–æ –≥–∏–ø–æ—Ç–µ–∑–∞ –ø—Ä–æ—Å—Ç–∞—è, –∏–Ω–∞—á–µ - —Å–ª–æ–∂–Ω–∞—è.

# ------------------------------------------------------------------------------

# –ß–∞—Å—Ç—å 1

# –° –ø–æ–º–æ—â—å—é –∫—Ä–∏—Ç–µ—Ä–∏—è —Ö–∏-–∫–≤–∞–¥—Ä–∞—Ç –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≥–∏–ø–æ—Ç–µ–∑—É –æ –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ 
# –¥–≤—É—Ö —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫ –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π –Ω–∞ –∑–∞–¥–∞–Ω–Ω–æ–º —É—Ä–æ–≤–Ω–µ –∑–Ω–∞—á–∏–º–æ—Å—Ç–∏ 

# ------------------------------------------------------------------------------

# –ì–∏–ø–æ—Ç–µ–∑–∞ –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
# –ù–∞–±–ª—é–¥–∞–µ—Ç—Å—è –ø–∞—Ä–∞ —Å–ª—É—á–∞–π–Ω—ã—Ö –≤–µ–ª–∏—á–∏–Ω (Œæ, Œ∑). –ü–æ–ª—É—á–µ–Ω–∞ –≤—ã–±–æ—Ä–∫–∞ ((x1, y1), . . . ,
# (xn, yn)), –≤—ã–¥–≤–∏–≥–∞–µ—Ç—Å—è –≥–∏–ø–æ—Ç–µ–∑–∞ H0 = {Œæ –∏ Œ∑ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã} - —Å–ª–æ–∂–Ω–∞—è –≥–∏–ø–æ—Ç–µ–∑–∞
# –ø—Ä–æ—Ç–∏–≤ —Å–ª–æ–∂–Ω–æ–π –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã H1 = {H0 –Ω–µ–≤–µ—Ä–Ω–∞}.

# –°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –∫—Ä–∏—Ç–µ—Ä–∏–π: —Ñ—É–Ω–∫—Ü–∏—è ùõø, —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—â–∞—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –º–µ–∂–¥—É
# –Ω–∞–±–ª—é–¥–∞–µ–º—ã–º–∏ –≤–µ–ª–∏—á–∏–Ω–∞–º–∏ –∏ –≤–æ–∑–º–æ–∂–Ω—ã–º–∏ –≥–∏–ø–æ—Ç–µ–∑–∞–º–∏
# ùõø:ùë• = (ùë•1, ùë•2, ..., ùë•ùëõ) ‚Üí {ùêª0, ùêª1}
# –ï—Å–ª–∏ ùõø(X) = ùêªi, —Ç–æ –º—ã –ø—Ä–∏–Ω–∏–º–∞–µ–º –≥–∏–ø–æ—Ç–µ–∑—É ùêªi

# –ö–∞—á–µ—Å—Ç–≤–æ –∫—Ä–∏—Ç–µ—Ä–∏—è —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏–∑—É–µ—Ç—Å—è –Ω–∞–±–æ—Ä–æ–º –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π –æ—à–∏–±–æ—á–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π.
# –ë—É–¥–µ–º –≥–æ–≤–æ—Ä–∏—Ç—å, —á—Ç–æ –ø—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ 1-–≥–æ (2-–≥–æ) —Ä–æ–¥–∞, –µ—Å–ª–∏ –æ—Å–Ω–æ–≤–Ω–∞—è –≥–∏–ø–æ—Ç–µ–∑–∞
# H0 (–∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∞—è H1) –æ—Ç–≤–µ—Ä–≥–Ω—É—Ç–∞, –∫–æ–≥–¥–∞ –æ–Ω–∞ –≤–µ—Ä–Ω–∞.

# –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å—é –æ—à–∏–±–∫–∏ 1-–≥–æ —Ä–æ–¥–∞ –∫—Ä–∏—Ç–µ—Ä–∏—è Œ¥ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è
# Œ±1(Œ¥) = P(Œ¥(X) != H0|H0).

# –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å—é –æ—à–∏–±–∫–∏ 2-–≥–æ —Ä–æ–¥–∞ –∫—Ä–∏—Ç–µ—Ä–∏—è Œ¥ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è
# Œ±2(Œ¥) = P(Œ¥(X) != H1|H1)

# ------------------------------------------------------------------------------

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –≥–∏–ø–æ—Ç–µ–∑—ã –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —Å –ø–æ–º–æ—â—å—é –∫—Ä–∏—Ç–µ—Ä–∏—è œá^2

# –ü—Ä–µ–¥–ø–æ–ª–æ–∂–∏–º, —á—Ç–æ –≤ –Ω–µ–∫–æ—Ç–æ—Ä–æ–º —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–µ –Ω–∞–±–ª—é–¥–∞–µ—Ç—Å—è —Å–ª—É—á–∞–π–Ω–∞—è –≤–µ–ª–∏—á–∏–Ω–∞ (X, Y)
# —Å –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–µ–π —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è F (x, y), –∏ –µ—Å—Ç—å –æ—Å–Ω–æ–≤–∞–Ω–∏–µ –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞—Ç—å, —á—Ç–æ
# –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã X –∏ Y –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã. –í —ç—Ç–æ–º —Å–ª—É—á–∞–µ –Ω–∞–¥–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≥–∏–ø–æ—Ç–µ–∑—É –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ 
# H0 = {F (x, y) = FX (x)¬∑FY (y)}, –≥–¥–µ FX (x) –∏ FY (y) - –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –æ–¥–Ω–æ–º–µ—Ä–Ω—ã–µ
# —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è, –ø—Ä–æ—Ç–∏–≤ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ–π –≥–∏–ø–æ—Ç–µ–∑—ã H1 = {H0 –Ω–µ–≤–µ—Ä–Ω–∞}.

# –ü—É—Å—Ç—å –∏–º–µ–µ—Ç—Å—è –≤—ã–±–æ—Ä–∫–∞ (x, y) = ((x1, y1), (x2, y2), . . . , (xn, yn)) –∏–∑ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è 
# —Å–ª—É—á–∞–π–Ω–æ–π –≤–µ–ª–∏—á–∏–Ω—ã (X, Y ). –ü—Ä–æ—Å—Ç–æ–π –∫—Ä–∏—Ç–µ—Ä–∏–π —Å–æ–≥–ª–∞—Å–∏—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –≥–∏–ø–æ—Ç–µ–∑—ã
# H0 –¥–ª—è —ç—Ç–æ–π –≤—ã–±–æ—Ä–∫–∏ –º–æ–∂–Ω–æ –ø–æ—Å—Ç—Ä–æ–∏—Ç—å, –æ—Å–Ω–æ–≤—ã–≤–∞—è—Å—å –Ω–∞ –º–µ—Ç–æ–¥–∏–∫–µ œá2.

# –°–ª—É—á–∞–π–Ω–∞—è –≤–µ–ª–∏—á–∏–Ω–∞ X –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –∫–æ–Ω–µ—á–Ω–æ–µ —á–∏—Å–ª–æ s
# —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –æ–±–æ–∑–Ω–∞—á–∏–º u1, u2, ..., us, –∞ –≤—Ç–æ—Ä–∞—è
# –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ Y - k –∑–Ω–∞—á–µ–Ω–∏–π v1, v2, ..., vk.  

# –û–±–æ–∑–Ω–∞—á–∏–º —á–µ—Ä–µ–∑ ŒΩij —á–∏—Å–ª–æ –Ω–∞–±–ª—é–¥–µ–Ω–∏–π –ø–∞—Ä—ã (ui, vj) , —Ç–∞–∫ —á—Ç–æ

#  s   k
#  ‚àë   ‚àë ŒΩij = n
# i=1 j=1

# –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –Ω–∞–±–ª—é–¥–µ–Ω–∏–π —É–¥–æ–±–Ω–æ —Ä–∞—Å–ø–æ–ª–æ–∂–∏—Ç—å –≤ –≤–∏–¥–µ —Ç–∞–±–ª–∏—Ü—ã —Å–æ–ø—Ä—è–∂–µ–Ω–Ω–æ—Å—Ç–∏ –¥–≤—É—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤

# –î–∞–ª–µ–µ –≤—ã—á–∏—Å–ª—è–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏:

# ^      (                        )
# œá2 = n ( ‚àë vij^2 / (vi ‚Ä¢ vj) - 1)
#  n     (i,j                     )

# –¢–µ–æ—Ä–µ–º–∞: –í —Å–ª—É—á–∞–µ —Å–ø—Ä–∞–≤–µ–¥–ª–∏–≤–æ—Å—Ç–∏ –≥–∏–ø–æ—Ç–µ–∑—ã H0 –ø—Ä–∏ n ‚Üí ‚àû
# ^
# œá2 ‚Üí Z, –≥–¥–µ —Å–ª—É—á–∞–π–Ω–∞—è –≤–µ–ª–∏—á–∏–Ω–∞ Z –∏–º–µ–µ—Ç —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ œá2 —Å (s ‚àí 1)(k ‚àí 1) —Å—Ç–µ–ø–µ–Ω—è–º–∏ —Å–≤–æ–±–æ–¥—ã.
#  n  

# –ö—Ä–∏—Ç–µ—Ä–∏–π —Å–æ–≥–ª–∞—Å–∏—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –≥–∏–ø–æ—Ç–µ–∑—ã –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:

#           {          ^        
#           {H0,  –µ—Å–ª–∏ œá2 < œá2             ,
# p(x, y) = {           n    1‚àíŒµ,(s‚àí1)(k‚àí1)
#           {
#           {          ^
#           {H1, –µ—Å–ª–∏  œá2 ‚â• œá2             .
#           {           n    1‚àíŒµ,(s‚àí1)(k‚àí1)

bmw_df <- read.csv("bmw.csv")
bmw_x1_df <- subset(bmw_df, bmw_df$model == ' X1' & bmw_df$engineSize != 0.0 & bmw_df$year < 2023)

bmw_table <- table(bmw_x1_df$year, bmw_x1_df$fuelType)
View(bmw_table)

bmw_x1_df$year_united <- bmw_x1_df$year
bmw_x1_df$year_united[bmw_x1_df$year %in% seq(2010,2016)] = '2010-2016'

bmw_table <- table(bmw_x1_df$year_united, bmw_x1_df$fuelType)
View(bmw_table)

# –ö—Ä–∏—Ç–µ—Ä–∏–µ–º —Å–æ–≥–ª–∞—Å–∏—è –Ω–∞–∑—ã–≤–∞—é—Ç –∫—Ä–∏—Ç–µ—Ä–∏–π, –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–Ω—ã–π –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –æ—Å–Ω–æ–≤–Ω–æ–π
# –≥–∏–ø–æ—Ç–µ–∑—ã H0 = {F = F0} –ø—Ä–∏ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–µ H1 = {H0 –Ω–µ–≤–µ—Ä–Ω–∞}.

# –ö—Ä–∏—Ç–µ—Ä–∏–π —Å–æ–≥–ª–∞—Å–∏—è –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –∏–ª–∏ –æ—Ç–≤–µ—Ä–≥–∞–µ—Ç –æ—Å–Ω–æ–≤–Ω—É—é –≥–∏–ø–æ—Ç–µ–∑—É, –∏—Å—Ö–æ–¥—è –∏–∑ –≤–µ–ª–∏—á–∏–Ω—ã
# –Ω–µ–∫–æ—Ç–æ—Ä–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ œÅ(x), –Ω–∞–∑—ã–≤–∞–µ–º–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π, - —Ñ—É–Ω–∫—Ü–∏–∏ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è —ç–º–ø–∏—Ä–∏—á–µ—Å–∫–æ–≥–æ
# —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –æ—Ç —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–æ–≥–æ.

# –ü–æ–ª—É—á–∞–µ–º –∫—Ä–∏—Ç–µ—Ä–∏–π —Å–æ–≥–ª–∞—Å–∏—è œá^2 –ü–∏—Ä—Å–æ–Ω–∞ (–≤—ã–±.)
chisq.test(bmw_table) # œá^2 = 149.45

freedom_degree <- (2 - 1)
a <- 0.001 # —É—Ä–æ–≤–µ–Ω—å –∑–Ω–∞—á–∏–º–æ—Å—Ç–∏ –∫—Ä–∏—Ç–µ—Ä–∏—è

# –£—Ä–æ–≤–Ω–µ–º –∑–Ω–∞—á–∏–º–æ—Å—Ç–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–æ–≥–æ –∫—Ä–∏—Ç–µ—Ä–∏—è Œ± –Ω–∞–∑—ã–≤–∞—é—Ç –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –æ—à–∏–±–æ—á–Ω–æ
# –æ—Ç–≤–µ—Ä–≥–Ω—É—Ç—å –æ—Å–Ω–æ–≤–Ω—É—é –ø—Ä–æ–≤–µ—Ä—è–µ–º—É—é –≥–∏–ø–æ—Ç–µ–∑—É, –∫–æ–≥–¥–∞ –æ–Ω–∞ –≤–µ—Ä–Ω–∞, —Ç.–µ. Œ± = Œ±1(Œ¥).

# –ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
xcr <- qchisq(p = 1 - a, df = freedom_degree) # 10.82757

# 149.45 > 10.82757 —Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ –≥–∏–ø–æ—Ç–µ–∑–∞ –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç–∫–ª–æ–Ω—è–µ—Ç—Å—è

# –ß–∞—Å—Ç—å 2

# 1. –ù–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–æ–∑–¥–∞—Ç—å –º–æ–¥–µ–ª—å –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—è —Ü–µ–Ω—ã –∞–≤—Ç–æ–º–æ–±–∏–ª—è
# –ø–æ –µ–≥–æ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞–º. –î–ª—è —ç—Ç–æ–≥–æ –ø–æ—Å—Ç—Ä–æ–∏—Ç—å 2 –º–æ–¥–µ–ª–∏ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–π 
# –ª–∏–Ω–µ–π–Ω–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏

#-------------------------------------------------------------------------------

# –î–≤—É–º–µ—Ä–Ω–∞—è –≤—ã–±–æ—Ä–∫–∞
# (x, y) = ((x1, y1), (x2, y2), ..., (xn, yn))

# –í—ã–±–æ—Ä–æ—á–Ω–∞—è –∫–æ–≤–∞—Ä–∏–∞—Ü–∏—è:

#                   n        _       _
# cov–≤(X, X) = 1/n  ‚àë [(xi ‚àí x)(yi ‚àí y)];
#                  i=1      

# –í—ã–±–æ—Ä–æ—á–Ω—ã–π –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏:

#
# œÅ–≤(X, Y) = cov–≤(X, Y) / SX SY
#     _  _
# –≥–¥–µ x, y - –∑–Ω–∞—á–µ–Ω–∏—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö —Å—Ä–µ–¥–Ω–∏—Ö –≤—ã–±–æ—Ä–æ—á–Ω—ã—Ö;
# SX , SY - –∑–Ω–∞—á–µ–Ω–∏—è –≤—ã–±–æ—Ä–æ—á–Ω—ã—Ö —Å—Ä–µ–¥–Ω–µ–∫–≤–∞–¥—Ä–∞—Ç–∏—á–µ—Å–∫–∏—Ö –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–π.

# –¢–∞–∫ –∫–∞–∫ –≤—ã–±–æ—Ä–∫–∞ (x, y) —Å–ª—É—á–∞–π–Ω–∞, —Ç–æ –≤—ã–±–æ—Ä–æ—á–Ω—ã–π –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ —è–≤–ª—è–µ—Ç—Å—è 
# —Å–ª—É—á–∞–π–Ω–æ–π –≤–µ–ª–∏—á–∏–Ω–æ–π –∏ –º–æ–∂–µ—Ç —Å–ª—É–∂–∏—Ç—å —Ç–æ—á–µ—á–Ω–æ–π –æ—Ü–µ–Ω–∫–æ–π –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏
# —Å–ª—É—á–∞–π–Ω—ã—Ö –≤–µ–ª–∏—á–∏–Ω X –∏ Y.

# –†–µ–≥—Ä–µ—Å—Å–∏–æ–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑:

# –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –ø–æ–∑–≤–æ–ª—è–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ö–∞—Ä–∞–∫—Ç–µ—Ä –∏ —Ç–µ—Å–Ω–æ—Ç—É —Å–≤—è–∑–∏ –º–µ–∂–¥—É —Å–ª—É—á–∞–π–Ω—ã–º–∏
# –≤–µ–ª–∏—á–∏–Ω–∞–º–∏. –ù–µ –º–µ–Ω–µ–µ –≤–∞–∂–Ω–æ –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –≤—ã—è–≤–ª–µ–Ω–Ω–æ–π –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏, –¥–∞—é—â–µ–µ
# –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —á–∏—Å–ª–µ–Ω–Ω–æ –æ—Ü–µ–Ω–∏—Ç—å –æ–¥–Ω–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —á–µ—Ä–µ–∑ –¥—Ä—É–≥–∏–µ.

# –ü—Ä–æ–≤–µ–¥–µ–Ω–∏–µ —Ä–µ–≥—Ä–µ—Å—Å–∏–æ–Ω–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –º–æ–∂–Ω–æ —Ä–∞–∑–¥–µ–ª–∏—Ç—å –Ω–∞ —Ç—Ä–∏ —ç—Ç–∞–ø–∞:
# 1) –≤—ã–±–æ—Ä —Ñ–æ—Ä–º—ã –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (—Ç–∏–ø–∞ —É—Ä–∞–≤–Ω–µ–Ω–∏—è);
# 2) –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤ –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —É—Ä–∞–≤–Ω–µ–Ω–∏—è;
# 3) –æ—Ü–µ–Ω–∫–∞ –¥–æ—Å—Ç–æ–≤–µ—Ä–Ω–æ—Å—Ç–∏ –ø–æ–ª—É—á–µ–Ω–Ω–æ–≥–æ —É—Ä–∞–≤–Ω–µ–Ω–∏—è.

# –ü—É—Å—Ç—å –Ω–∞–±–ª—é–¥–∞–µ–º–∞—è —Å–ª—É—á–∞–π–Ω–∞—è –≤–µ–ª–∏—á–∏–Ω–∞ Y –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Å–ª—É—á–∞–π–Ω–æ–π –≤–µ–ª–∏—á–∏–Ω—ã X.
# –û–±–æ–∑–Ω–∞—á–∏–º —á–µ—Ä–µ–∑ f (x) —Ñ—É–Ω–∫—Ü–∏—é, –∑–∞–¥–∞—é—â—É—é –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å —Å—Ä–µ–¥–Ω–µ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è Y –æ—Ç
# –∑–Ω–∞—á–µ–Ω–∏–π X
# f(x) = M (Y / X = x)
# –£—Ä–∞–≤–Ω–µ–Ω–∏–µ y = f(x) –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è —É—Ä–∞–≤–Ω–µ–Ω–∏–µ–º —Ä–µ–≥—Ä–µ—Å—Å–∏–∏.

# –¢—Ä–µ–±—É–µ—Ç—Å—è –ø–æ –∑–Ω–∞—á–µ–Ω–∏—è–º x1, . . . , xn –∏ y1, . . . , yn –æ—Ü–µ–Ω–∏—Ç—å –∫–∞–∫ –º–æ–∂–Ω–æ —Ç–æ—á–Ω–µ–µ —Ñ—É–Ω–∫—Ü–∏—é
# f (x).
# –°–Ω–∞—á–∞–ª–∞ –∑–∞—Ä–∞–Ω–µ–µ –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç –≤–∏–¥ f (x), –∑–∞–ø–∏—Å—ã–≤–∞—è f (x) –≤ –≤–∏–¥–µ –Ω–µ–∫–æ—Ç–æ—Ä–æ–π k-–ø–∞—Ä–∞–º–µ—Ç—Ä–∏—á–µ—Å–∫–æ–π
# —Ñ—É–Ω–∫—Ü–∏–∏ f (x, Œ∏), Œ∏ = (Œ∏1, . . . , Œ∏k)

# –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–∞—è –ª–∏–Ω–µ–π–Ω–∞—è —Ä–µ–≥—Ä–µ—Å—Å–∏—è - –≤—ã—Ä–∞–∂–µ–Ω–Ω–∞—è –≤ –≤–∏–¥–µ –ø—Ä—è–º–æ–π –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å —Å—Ä–µ–¥–Ω–µ–≥–æ
# –∑–Ω–∞—á–µ–Ω–∏—è –≤–µ–ª–∏—á–∏–Ω—ã Y –æ—Ç –¥–≤—É—Ö –∏ –±–æ–ª–µ–µ –¥—Ä—É–≥–∏—Ö –≤–µ–ª–∏—á–∏–Ω X1, X2, ..., Xm.
# –í–µ–ª–∏—á–∏–Ω—É Y –ø—Ä–∏–Ω—è—Ç–æ –Ω–∞–∑—ã–≤–∞—Ç—å –∑–∞–≤–∏—Å–∏–º–æ–π –∏–ª–∏ —Ä–µ–∑—É–ª—å—Ç–∏—Ä—É—é—â–µ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π,
# –∞ –≤–µ–ª–∏—á–∏–Ω—ã X1, X2, ..., Xm - –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–º–∏ –∏–ª–∏ –æ–±—ä—è—Å–Ω—è—é—â–∏–º–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏.
# –í —Å–ª—É—á–∞–µ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–π –ª–∏–Ω–µ–π–Ω–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å —Ä–µ–∑—É–ª—å—Ç–∏—Ä—É—é—â–µ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π 
# –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –æ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –æ–±—ä—è—Å–Ω—è—é—â–∏—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–ø–∏—Å—ã–≤–∞–µ—Ç —É—Ä–∞–≤–Ω–µ–Ω–∏–µ.
# –£—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ä–µ–≥—Ä–µ—Å—Å–∏–∏:
# ^
# y = b0 + b1x1 + b2x2 + ... + bnxn

# –ü–∞—Ä–Ω–∞—è –ª–∏–Ω–µ–π–Ω–∞—è —Ä–µ–≥—Ä–µ—Å—Å–∏—è
# –†–µ–≥—Ä–µ—Å—Å–∏—è –≤—ã—Ä–∞–∂–∞–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å Y –æ—Ç X, –Ω–∞–∏–ª—É—á—à—É—é –≤ —Å–º—ã—Å–ª–µ –º–∏–Ω–∏–º–∏–∑–∞—Ü–∏–∏ –æ—Å—Ç–∞—Ç–æ—á–Ω–æ–π –¥–∏—Å–ø–µ—Ä—Å–∏–∏:

# M(Y ‚àí M(Y|X))^2

# –ü—Ä—è–º–∞—è —Å—Ä–µ–¥–Ω–µ–∫–≤–∞–¥—Ä–∞—Ç–∏—á–µ—Å–∫–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ Y –Ω–∞ X:
# 
# y = MY + œÅ ‚Ä¢ œÉ(Y)/œÉ(X) ‚Ä¢ (x ‚àí MX), rYX = œÅ ‚Ä¢ œÉ(Y)/œÉ(X) 

# –í–µ–ª–∏—á–∏–Ω–∞ rY X –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–º —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ Y –Ω–∞ X.

# –ü—Ä—è–º–∞—è —Å—Ä–µ–¥–Ω–µ–∫–≤–∞–¥—Ä–∞—Ç–∏—á–µ—Å–∫–∞—è —Ä–µ–≥—Ä–µ—Å–∏–∏—è X –Ω–∞ Y –∏ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ X –Ω–∞ Y:

# x = MX + œÅ ‚Ä¢ œÉ(X)/œÉ(Y) ‚Ä¢ (y ‚àí MY), rXY = œÅ ‚Ä¢ œÉ(X)/œÉ(Y)

# –í–µ–ª–∏—á–∏–Ω–∞ ‚àÜ = œÉ^2(Y)(1 ‚àí œÅ^2) –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è –æ—Å—Ç–∞—Ç–æ—á–Ω–æ–π –¥–∏—Å–ø–µ—Ä—Å–∏–µ–π Y –Ω–∞ X. –û–Ω–∞
# –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –≤–µ–ª–∏—á–∏–Ω—É –æ—à–∏–±–∫–∏ –ø—Ä–∏–±–ª–∏–∂–µ–Ω–Ω–æ–≥–æ —Ä–∞–≤–µ–Ω—Å—Ç–≤–∞ Y ‚âà aX + b.

# –ü–æ–¥—Å—Ç–∞–≤–ª—è—è –≤ —É—Ä–∞–≤–Ω–µ–Ω–∏—è –≤–º–µ—Å—Ç–æ œÉ(X), œÉ(Y), M(X), M(Y), œÅ –∏—Ö 
# —Ç–æ—á–µ—á–Ω—ã–µ –æ—Ü–µ–Ω–∫–∏, –ø–æ–ª—É—á–∞–µ–º —É—Ä–∞–≤–Ω–µ–Ω–∏—è –≤—ã–±–æ—Ä–æ—á–Ω—ã—Ö –ø—Ä—è–º—ã—Ö —Å—Ä–µ–¥–Ω–µ–∫–≤–∞–¥—Ä–∞—Ç–∏—á–µc–∫–∏—Ö
# —Ä–µ–≥—Ä–µ—Å—Å–∏–π Y –Ω–∞ X –∏ X –Ω–∞ Y

#     _                     _       _                     _
# y = y + œÅ–≤ ‚Ä¢ SY/SX ‚Ä¢ (x ‚àí x), x = x + œÅ–≤ ‚Ä¢ SX/SY ‚Ä¢ (y ‚àí y)

# –ú–æ–¥–µ–ª—å 1: –≤ –∫–∞—á–µ—Å—Ç–≤–µ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤—Å–µ 
# n —á–∏—Å–ª–æ–≤—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —á–∏—Å–ª–æ–≤—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å, –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–≤
# —Å—Ç–æ–ª–±—Ü—ã —Å–≤–æ–µ–≥–æ –Ω–∞–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö).

# –ß—Ç–æ–±—ã –ø–æ–¥–æ–±—Ä–∞—Ç—å –º–æ–¥–µ–ª—å –ª–∏–Ω–µ–π–Ω–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ –≤ R, –º—ã –º–æ–∂–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–æ–º–∞–Ω–¥—É lm().

model_1 <- lm(price ~ year + mileage + tax + mpg + engineSize, bmw_x1_df)

# –ß—Ç–æ–±—ã –ø—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤—ã–≤–æ–¥ –º–æ–¥–µ–ª–∏ —Ä–µ–≥—Ä–µ—Å—Å–∏–∏, –º—ã –º–æ–∂–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–æ–º–∞–Ω–¥—É summary().
summary(model_1)

# R-squared (–∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –¥–µ—Ç–µ—Ä–º–∏–Ω–∞—Ü–∏–∏ –º–æ–¥–µ–ª–∏): 0.8884

# –§–æ—Ä–º—É–ª–∞ –ø–æ–ª—É—á–∏–≤—à–µ–π—Å—è —Ä–µ–≥—Ä–µ—Å—Å–∏–∏:
# f(x) = 2.081e+03 * year - 8.891e-02 * mileage + 7.393e+00 * tax -
# - 1.221e+02 * mpg + 5.574e+03 * engineSize - 4.179e+06

plot(model_1, col="blue", main="–ì—Ä–∞—Ñ–∏–∫ 1 –º–æ–¥–µ–ª–∏")

# Residuals vs Fitted

# –ì—Ä–∞—Ñ–∏–∫ –æ—Å—Ç–∞—Ç–∫–æ–≤ –ø—Ä–æ—Ç–∏–≤ –ø–æ–¥–æ–≥–Ω–∞–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
# –û–Ω –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ–±–Ω–∞—Ä—É–∂–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ç–∏–ø–æ–≤ –Ω–∞—Ä—É—à–µ–Ω–∏–π –≤ –ø—Ä–µ–¥–ø–æ–ª–æ–∂–µ–Ω–∏—è—Ö –ª–∏–Ω–µ–π–Ω–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏
# –ó–¥–µ—Å—å –æ—Å—Ç–∞—Ç–∫–∏ –Ω–∞ –æ—Å–∏ y –∏ –ø–æ–¥–æ–≥–Ω–∞–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –Ω–∞ –æ—Å–∏ x

# –ì—Ä–∞—Ñ–∏–∫ –æ—Å—Ç–∞—Ç–∫–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø–æ–∏—Å–∫–∞ –æ—Å–Ω–æ–≤–Ω—ã—Ö –∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç–µ–π –≤ –æ—Å—Ç–∞—Ç–∫–∞—Ö,
# –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –æ–∑–Ω–∞—á–∞—Ç—å, —á—Ç–æ –≤ –º–æ–¥–µ–ª–∏ –µ—Å—Ç—å –ø—Ä–æ–±–ª–µ–º–∞. –ì—Ä–∞—Ñ–∏–∫ –¥–∞—ë—Ç —É–∫–∞–∑–∞–Ω–∏–µ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ
# –Ω–µ–ª–∏–Ω–µ–π–Ω—ã—Ö —à–∞–±–ª–æ–Ω–æ–≤. –î–ª—è –ª–∏–Ω–µ–π–Ω–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ –¥–∞–Ω–Ω—ã–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å
# –ª–∏–Ω–µ–π–Ω—ã–º–∏, —á—Ç–æ–±—ã –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ª–∏ —ç—Ç–æ —É—Å–ª–æ–≤–∏–µ

# Normal Q-Q (quantil - quantile plot)

# –û—Å—Ç–∞—Ç–∫–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –Ω–æ—Ä–º–∞–ª—å–Ω–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω—ã, –∏ –≥—Ä–∞—Ñ–∏–∫ Q-Q –ø–æ–∫–∞–∂–µ—Ç —ç—Ç–æ.
# –ï—Å–ª–∏ –Ω–∞ —ç—Ç–æ–º –≥—Ä–∞—Ñ–∏–∫–µ –æ—Å—Ç–∞—Ç–∫–∏ —Å–ª–µ–¥—É—é—Ç –±–ª–∏–∑–∫–æ –∫ –ø—Ä—è–º–æ–π –ª–∏–Ω–∏–∏, —ç—Ç–æ —Ö–æ—Ä–æ—à–∏–π
# –ø—Ä–∏–∑–Ω–∞–∫ —Ç–æ–≥–æ, —á—Ç–æ –æ–Ω–∏ –Ω–æ—Ä–º–∞–ª—å–Ω–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω—ã

# Scale-Location

# –≠—Ç–æ –≥—Ä–∞—Ñ–∏–∫ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø—Ä–µ–¥–ø–æ–ª–æ–∂–µ–Ω–∏–µ –ª–∏–Ω–µ–π–Ω–æ–π —Ä–µ–≥—Ä–µ—Å–∏–∏ –æ —Ä–∞–≤–Ω–æ–π –¥–∏—Å–ø–µ—Ä—Å–∏–∏, —Ç.–µ.
# –æ —Ç–æ–º, —á—Ç–æ –æ—Å—Ç–∞—Ç–∫–∏ –∏–º–µ—é—Ç —Ä–∞–≤–Ω—É—é –¥–∏—Å–ø–µ—Ä—Å–∏—é –≤–¥–æ–ª—å –ª–∏–Ω–∏–∏ —Ä–µ–≥—Ä–µ—Å–∏–∏–∏. –ï–≥–æ
# —Ç–∞–∫–∂–µ –Ω–∞–∑—ã–≤–∞—é—Ç –≥—Ä–∞—Ñ–∏–∫–æ–º —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è-–º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏—è

# Residuals vs Leverage

# –≠—Ç–æ—Ç –≥—Ä–∞—Ñ–∏–∫ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –ø–æ–∏—Å–∞ –≤–ª–∏—è—Ç–µ–ª—å–Ω—ã—Ö —Å–ª—É—á–∞–µ–≤ –≤ –Ω–∞–±–æ—Ä–µ –¥–∞–Ω–Ω—ã—Ö,
# –í–ª–∏—è—Ç–µ–ª—å–Ω—ã–π —Å–ª—É—á–∞–π - —ç—Ç–æ —Ç–æ—Ç, –∫–æ—Ç–æ—Ä—ã–π, –µ—Å–ª–∏ –µ–≥–æ —É–¥–∞–ª–∏—Ç—å, –ø–æ–≤–ª–∏—è–µ—Ç –Ω–∞ –º–æ–¥–µ–ª—å,
# –ø–æ—ç—Ç–æ–º—É —Å–ª–µ–¥—É–µ—Ç —Ä–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –µ–≥–æ –≤–∫–ª—é—á–µ–Ω–∏—è –∏–ª–∏ –∏—Å–∫–ª—é—á–µ–Ω–∏—è.
# –¶–µ–ª—å —ç—Ç–æ–π –¥–∏–∞–≥—Ä–∞–º–º—ã —Å–æ—Å—Ç–æ–∏—Ç –≤ —Ç–æ–º, —á—Ç–æ–±—ã –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Å–ª—É—á–∞–∏, –∫–æ—Ç–æ—Ä—ã–µ –∏–º–µ—é—Ç
# –±–æ–ª—å—à–æ–µ –≤–ª–∏—è–Ω–∏–µ –≤ –º–æ–¥–µ–ª–∏. –í—ã–±—Ä–æ—Å—ã –±—É–¥—É—Ç –∏–º–µ—Ç—å —Ç–µ–Ω–¥–µ–Ω—Ü–∏—é –æ–∫–∞–∑—ã–≤–∞—Ç—å –≤–ª–∏—è–Ω–∏–µ –∏,
# —Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ, –≤–ª–∏—è—Ç—å –Ω–∞ –º–æ–¥–µ–ª—å.

# –ú–æ–¥–µ–ª—å 2: —Å—Ä–µ–¥–∏ –≤—Å–µ–≥–æ –º–Ω–æ–∂–µ—Ç—Å—Ç–≤–∞ —á–∏—Å–ª–æ–≤—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –Ω–∞–π—Ç–∏ 2, –Ω–∞–∏–±–æ–ª–µ–µ —Å–∏–ª—å–Ω–æ
# –∫–æ—Ä—Ä–µ–ª–∏—Ä—É—é—â–∏–µ –º–µ–∂–¥—É —Å–æ–±–æ–π. –¢–æ—Ç –∏–∑ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–∏ —ç—Ç–æ–º —Å–ª–∞–±–µ–µ 
# –∫–æ—Ä—Ä–µ–ª–∏—Ä—É–µ—Ç —Å —Ü–µ–Ω–æ–π –∞–≤—Ç–æ–º–æ–±–∏–ª—è, –∏—Å–∫–ª—é—á–∏—Ç—å –∏–∑ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏—è.  –ü–æ –æ—Å—Ç–∞–≤—à–∏–º—Å—è n-1 
# —á–∏—Å–ª–æ–≤—ã–º –ø—Ä–∏–∑–Ω–∞–∫–∞–º –ø–æ—Å—Ç—Ä–æ–∏—Ç—å –º–æ–¥–µ–ª—å –ª–∏–Ω–µ–π–Ω–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ –¥–ª—è –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—è —Ü–µ–Ω—ã –∞–≤—Ç–æ.

library(corrplot)
M <- cor(info_1)
M
corrplot(M, method="color", addCoef.col="purple", number.digits=1, number.cex = 1.3, 
         main="–ö–æ—Ä—Ä–µ–ª—è—Ü–∏—è –º–µ–∂–¥—É –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏")

# –ú–µ–∂–¥—É —Å–æ–±–æ–π –Ω–∞–∏–±–æ–ª—å–Ω–æ —Å–∏–ª—å–Ω–æ –∫–æ—Ä—Ä–µ–ª–∏—Ä—É—é—Ç mileage –∏ year. –ò–∑ —ç—Ç–∏—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
# mileage —Å–ª–∞–±–µ–µ –∫–æ—Ä—Ä–µ–ª–∏—Ä—É–µ—Ç —Å —Ü–µ–Ω–æ–π –∞–≤—Ç–æ–º–æ–±–∏–ª—è, –ø–æ—ç—Ç–æ–º—É –∏—Å–∫–ª—é—á–∏–º –µ–≥–æ –∏–∑ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏—è. 

model_2 <- lm(price ~ year + tax + mpg + engineSize, bmw_x1_df)
summary(model_2) 

# R-squared (–∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –¥–µ—Ç–µ—Ä–º–∏–Ω–∞—Ü–∏–∏ –º–æ–¥–µ–ª–∏): 0.8467

# –§–æ—Ä–º—É–ª–∞ –ø–æ–ª—É—á–∏–≤—à–µ–π—Å—è —Ä–µ–≥—Ä–µ—Å—Å–∏–∏:
# f(x) = 2.835e+03 * year + 1.196e+01 * tax - 1.449e+02 * mpg + 5.515e+03 * engineSize - 5.703e+06

plot(model_2, col="blue", main="–ì—Ä–∞—Ñ–∏–∫ 2 –º–æ–¥–µ–ª–∏")

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —É—Å–ª–æ–≤–∏—è –∞–¥–µ–∫–≤–∞—Ç–Ω–æ—Å—Ç–∏ –∫–∞–∂–¥–æ–π –∏–∑ –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π 
# —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ (–Ω–æ—Ä–º–∞–ª—å–Ω–æ—Å—Ç—å —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ä–µ–≥—Ä–µ—Å—Å–∏–æ–Ω–Ω—ã—Ö –æ—Å—Ç–∞—Ç–∫–æ–≤), –ø–æ—Å—Ç—Ä–æ–∏–≤ Q-Q –≥—Ä–∞—Ñ–∏–∫.

# –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ Q-Q plot
e=residuals(model_1)
qqnorm(e, pch=1, col="red", main = "Q-Q –≥—Ä–∞—Ñ–∏–∫ –¥–ª—è 1 –º–æ–¥–µ–ª–∏")
qqline(e, lty=2, col="blue")

legend("bottomright", c("–£—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ä–µ–≥—Ä–µ—Å—Å–∏–∏","–†–µ–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–∏"), 
       col=c("blue", "red"), lwd=4, cex=0.8, box.lty=0)

e=residuals(model_2)
qqnorm(e, pch=1, col="red", main = "Q-Q –≥—Ä–∞—Ñ–∏–∫ –¥–ª—è 2 –º–æ–¥–µ–ª–∏")
qqline(e, lty=2, col="blue")

legend("bottomright", c("–£—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ä–µ–≥—Ä–µ—Å—Å–∏–∏","–†–µ–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–∏"), 
       col=c("blue", "red"), lwd=4, cex=0.8, box.lty=0)

# –° –ø–æ–º–æ—â—å—é –æ–±–µ–∏—Ö –º–æ–¥–µ–ª–µ–π –Ω–∞–π—Ç–∏ –ø—Ä–æ–≥–Ω–æ–∑ —Ü–µ–Ω—ã –∞–≤—Ç–æ–º–æ–±–∏–ª—è,
# –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–º –æ–±—Ä–∞–∑–æ–º –∑–∞–¥–∞–≤ –¥–ª—è –Ω–µ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö —á–∏—Å–ª–æ–≤—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤.

new_years <- c(2017, 2018, 2019, 2020)
new_mpgs <- c(50.0, 60.9, 65.9, 71.2)
new_engineSizes <- c(1.3, 1.5, 1.6,  1.8)
new_taxs <- c(0, 30, 45, 75)
new_mileages <- c(10231, 11243, 12124, 13214)

data_new <- data.frame(year = new_years, mileage = new_mileages, tax = new_taxs,
                       mpg = new_mpgs, engineSize = new_engineSizes) 
price_new <- predict(model_1, data_new)
price_new

data_new2 <- data.frame(year = new_years, tax = new_taxs, mpg = new_mpgs,
                        engineSize = new_engineSizes) 
price_new2 <- predict(model_2, data_new2)

price_new2

