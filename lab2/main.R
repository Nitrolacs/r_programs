# –ó–∞–¥–∞–Ω–∏–µ 1

# –ò–∑–≤–ª–µ–∫–∞–µ–º –≤—ã–±–æ—Ä–∫–∏ –º–µ–Ω—å—à–µ–≥–æ –æ–±—ä—ë–º–∞

# –í—ã–±–æ—Ä–∫–æ–π –æ–±—ä–µ–º–∞ n –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è –º–Ω–æ–∂–µ—Å—Ç–≤–æ
# x = (x1, x2, ..., xn)
# –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –Ω–∞–±–ª—é–¥–∞–µ–º—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π —Å–ª—É—á–∞–π–Ω–æ–π –≤–µ–ª–∏—á–∏–Ω—ã 
# –∏–∑ –µ—ë –≥–µ–Ω–µ—Ä–∞–ª—å–Ω–æ–π —Å–æ–≤–æ–∫—É–ø–Ω–æ—Å—Ç–∏.

# –í—ã–±–æ—Ä–∫–∞ –¥–æ–ª–∂–Ω–∞ –æ–±–ª–∞–¥–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–º–∏ —Å–≤–æ–π—Å—Ç–≤–∞–º–∏:
# —Ä–µ–ø—Ä–µ–∑–µ–Ω—Ç–∞—Ç–∏–≤–Ω–æ—Å—Ç—å                        –í—ã–≤–æ–¥—ã –æ –≤—ã–±–æ—Ä–∫–µ
# —Å–ª—É—á–∞–π–Ω–æ—Å—Ç—å          +      –ó–ë–ß     =>    –º–æ–∂–Ω–æ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–∏—Ç—å 
# n -> ‚àû                                    –Ω–∞ –≥–µ–Ω–µ—Ä–∞–ª—å–Ω—É—é —Å–æ–≤–æ–∫—É–ø–Ω–æ—Å—Ç—å

# –ó–∞–∫–æ–Ω –±–æ–ª—å—à–∏—Ö —á–∏—Å–µ–ª:
# –ø—Ä–æ—è–≤–ª–µ–Ω–∏–µ —Å–≤–æ–π—Å—Ç–≤–∞ —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏ –¥–ª—è –º–∞—Å—Å–æ–≤—ã—Ö —Å–ª—É—á–∞–π–Ω—ã—Ö —è–≤–ª–µ–Ω–∏–π:
# –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –∫–∞–∂–¥–æ–≥–æ –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ —Å–ª—É—á–∞–π–Ω–æ–≥–æ —è–≤–ª–µ–Ω–∏—è 
# –ø–æ—á—Ç–∏ –Ω–µ —Å–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –Ω–∞ —Å—Ä–µ–¥–Ω–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –º–∞—Å—Å—ã —Ç–∞–∫–∏—Ö —è–≤–ª–µ–Ω–∏–π;
# —Å–ª—É—á–∞–π–Ω—ã–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è –æ—Ç —Å—Ä–µ–¥–Ω–µ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è –≤ –∫–∞–∂–¥–æ–º –æ—Ç–µ–¥–ª—å–Ω–æ —è–≤–ª–µ–Ω–∏–∏ –≤ –º–∞—Å—Å–µ
# –≤–∑–∞–∏–º–Ω–æ –ø–æ–≥–∞—à–∞—é—Ç—Å—è, –Ω–∏–≤–µ–ª–∏—Ä—É—é—Ç—Å—è, –≤—ã—Ä–∞–≤–Ω–∏–≤–∞—é—Ç—Å—è.
# –ü—Ä–∏ –æ—á–µ–Ω—å –±–æ–ª—å—à–æ–º —á–∏—Å–ª–µ —Å–ª—É—á–∞–π–Ω—ã—Ö —è–≤–ª–µ–Ω–∏–π —Å—Ä–µ–¥–Ω–∏–π –∏—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏
# –ø–µ—Ä–µ—Å—Ç–∞—ë—Ç –±—ã—Ç—å —Å–ª—É—á–∞–π–Ω—ã–º –∏ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω —Å –±–æ–ª—å—à–æ–π —Å—Ç–µ–ø–µ–Ω—å—é –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ—Å—Ç–∏.

# –≠–ª–µ–º–µ–Ω—Ç—ã 1-10
df1 <- read.csv("var20.csv", nrows = 10)

# –≠–ª–µ–º–µ–Ω—Ç—ã 1-50
df2 <- read.csv("var20.csv", nrows = 50)

# –í—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã –∏—Å—Ö–æ–¥–Ω–æ–π –≤—ã–±–æ—Ä–∫–∏
df3 <- read.csv("var20.csv")

# –ó–∞–¥–∞–Ω–∏–µ 2

# –î–ª—è –≤—ã–±–æ—Ä–æ–∫
# –í—ã—á–∏—Å–ª–∏–º —Å—Ä–µ–¥–Ω–µ–µ –≤—ã–±–æ—Ä–æ—á–Ω–æ–µ
# (—Å—É–º–º–∞ –≤—Å–µ—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤, –¥–µ–ª—ë–Ω–Ω–∞—è –Ω–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤—ã–±–æ—Ä–∫–∏)

mn_1 <- mean(df1$x)
mn_2 <- mean(df2$x)
mn_3 <- mean(df3$x)

# –í—ã–±–æ—Ä–æ—á–Ω—É—é –¥–∏—Å–ø–µ—Ä—Å–∏—é
# –§—É–Ω–∫—Ü–∏—è –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –≤—ã–±–æ—Ä–æ—á–Ω–æ–π –¥–∏—Å–ø–µ—Ä—Å–∏–∏
#                n       _
# –§–æ—Ä–º—É–ª–∞: 1/n * Œ£ (xi - x)^2
#               i=1  

dispersion <- function(v) {
  
  mn <- mean(v)
  
  result <- 0
  
  for (index in 1 : length(v)) {
    result <- result + ((v[index] - mn) ^ 2)
  }
  
  result <- result / length(v)
  return(result)
}

s_1 <- dispersion(df1$x)
s_2 <- dispersion(df2$x)
s_3 <- dispersion(df3$x)

# –ù–µ—Å–º–µ—â—ë–Ω–Ω—É—é –≤—ã–±–æ—Ä–æ—á–Ω—É—é –¥–∏—Å–ø–µ—Ä—Å–∏—é
#                  n       _
# –§–æ—Ä–º—É–ª–∞: 1/n-1 * Œ£ (xi - x)^2
#                 i=1  

s0_1 <- var(df1$x)
s0_2 <- var(df2$x)
s0_3 <- var(df3$x)


# –í—ã–±–æ—Ä–æ—á–Ω—ã–π –º–æ–º–µ–Ω—Ç –ø–æ—Ä—è–¥–∫–∞ k:

#          n
# ak = 1/n ‚àë (xi)^k
#         i=1


# –í—ã–±–æ—Ä–æ—á–Ω—ã–π —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –º–æ–º–µ–Ω—Ç –ø–æ—Ä—è–¥–∫–∞ k —Ä–∞–≤–µ–Ω
#  0         n
# ak = 1/n * ‚àë (xi - a1)^k
#           i=1

# –í—ã–±–æ—Ä–æ—á–Ω—ã–µ –∫–≤–∞–Ω—Ç–∏–ª–∏

# –ö–≤–∞–Ω—Ç–∏–ª—å—é –ø–æ—Ä—è–¥–∫–∞ q, 0 < q < 1 –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ–π —Å–ª—É—á–∞–π–Ω–æ–π
# –≤–µ–ª–∏—á–∏–Ω—ã Œæ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è –∑–Ω–∞—á–µ–Ω–∏–µ xq, –¥–ª—è –∫–æ—Ç–æ—Ä–æ–≥–æ F(xq) = q.

# –ö–≤–∞–Ω—Ç–∏–ª—å —É—Ä–æ–≤–Ω—è 1/2 –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è –º–µ–¥–∏–∞–Ω–æ–π.
# (–ú–æ–¥–∞ - —ç—Ç–æ –ª—é–±–∞—è —Ç–æ—á–∫–∞ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –º–∞–∫—Å–∏–º—É–º–∞ —Ñ. –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏)

# –ù–∞–ø—Ä–∏–º–µ—Ä, x0,1 = 15000 => 10% –ø–æ–ª—É—á–∞—é—Ç < 15000.

# –ö–≤–∞–Ω—Ç–∏–ª—å - –ª–µ–≤–µ–µ –¥–æ–ª–∂–Ω–æ —Ä–∞—Å–ø–æ–ª–æ–≥–∞—Ç—å—Å—è –∫–æ–ª-–≤–æ –∑–Ω–∞—á–µ–Ω–∏–π, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–µ
# –∏–Ω–¥–µ–∫—Å—É –∫–≤–∞–Ω—Ç–∏–ª–∏. –ù–∞–ø—Ä–∏–º–µ—Ä –¥–ª—è –∫–≤–∞–Ω—Ç–∏–ª–∏ x0.8 –ª–µ–≤–µ–µ –¥–æ–ª–∂–Ω–æ —Ä–∞—Å–ø–æ–ª–∞–≥–∞—Ç—å—Å—è
# 80% –∑–Ω–∞—á–µ–Ω–∏–π –≤—ã–±–æ—Ä–∫–∏.

q_1 <- quantile(df1$x)
q_2 <- quantile(df2$x)
q_3 <- quantile(df3$x)

# –ù–∞–π–¥—ë–º —Ç–æ—á–µ—á–Ω—ã–µ –æ—Ü–µ–Ω–∫–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è 
# ùëé–º–∞—Ç–æ–∂–∏–¥–∞–Ω–∏–µ –∏ ùúé^2 –¥–∏—Å–ø–µ—Ä—Å–∏—è
# –ú–∞—Ç. –æ–∂–∏–¥–∞–Ω–∏–µ - –≤—ã–±–æ—Ä–æ—á–Ω–æ–µ —Å—Ä–µ–¥–Ω–µ–µ
# –î–∏—Å–ø–µ—Ä—Å–∏—è - –≤—ã–±–æ—Ä–æ—á–Ω–∞—è –¥–∏—Å–ø–µ—Ä—Å–∏—è

# –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π (–≤ —É–∑–∫–æ–º —Å–º—ã—Å–ª–µ) –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è –ª—é–±–∞—è —Ñ—É–Ω–∫—Ü–∏—è ùúÉ‚àó(ùë•), –∫–æ—Ç–æ—Ä–∞—è –∑–∞–≤–∏—Å–∏—Ç —Ç–æ–ª—å–∫–æ –æ—Ç
# —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤—ã–±–æ—Ä–∫–∏.

exp_val_1 <- mn_1
var_1 <- s_1
exp_val_2 <- mn_2
var_2 <- s_2
exp_val_3 <- mn_3
var_3 <- s_3


# –°–ª—É—á–∞–π–Ω–∞—è –≤–µ–ª–∏—á–∏–Ω–∞ Œæ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ–π –µ—Å–ª–∏ –Ω–µ–ø—Ä–µ-
# —Ä—ã–≤–Ω–∞ –µ–µ —Ñ—É–Ω–∫—Ü–∏—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è FŒæ(x)
# –í —á–∞—Å—Ç–Ω–æ—Å—Ç–∏, F(x) –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∞ –≤ –≤–∏–¥–µ

#        x
# F(x) = ‚à´ f(t)dt,
#       ‚àí‚àû

# —Ñ—É–Ω–∫—Ü–∏—è f (t) –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø–ª–æ—Ç–Ω–æ-
# —Å—Ç—å—é —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è.

# –ù–æ—Ä–º–∞–ª—å–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ (–ì–∞—É—Å—Å–∞). –ù–æ—Ä–º–∞–ª—å–Ω—ã–π –∑–∞–∫–æ–Ω —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —è–≤–ª—è–µ—Ç—Å—è
# –ø—Ä–µ–¥–µ–ª—å–Ω—ã–º –∑–∞–∫–æ–Ω–æ–º.

# –ù–µ–ø—Ä–µ—Ä—ã–≤–Ω–∞—è —Å–ª—É—á–∞–π–Ω–∞—è –≤–µ–ª–∏—á–∏–Ω–∞ Œæ –∏–º–µ–µ—Ç –Ω–æ—Ä–º–∞–ª—å–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ (–æ–±–æ-
# –∑–Ω–∞—á–µ–Ω–∏–µ: Œæ ‚àà Na,œÉ^2), –µ—Å–ª–∏ –µ–µ –ø–ª–æ—Ç–Ω–æ—Å—Ç—å —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∏–º–µ–µ—Ç –≤–∏–¥
# f(x) = (1/œÉ‚àö2œÄ) * e ^ ‚àí(x‚àía)^2/2œÉ^2

# –§—É–Ω–∫—Ü–∏—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è:
#                   x
# F(x) = (1/œÉ‚àö2œÄ) * ‚à´ e ^ ‚àí(t‚àía)^2/2œÉ^2 dt,
#                  ‚àí‚àû 

# –≥–¥–µ a –∏ œÉ ‚Äì –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –ø–æ—Å—Ç–æ—è–Ω–Ω—ã–µ, –Ω–∞–∑—ã–≤–∞–µ–º—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è.
# –∞ —ç R - —Å—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è,
# œÉ^2 > 0 - –¥–∏—Å–ø–µ—Ä—Å–∏—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
# œÉ - —Å—Ä–µ–¥–Ω–µ–∫–≤–∞–¥—Ä–∞—Ç–∏—á–µ—Å–∫–æ–µ (—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ) –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è

# –î–∏—Å–ø–µ—Ä—Å–∏—è —Å–ª—É—á–∞–π–Ω–æ–π –≤–µ–ª–∏—á–∏–Ω—ã —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏–∑—É–µ—Ç —Å—Ç–µ–ø–µ–Ω—å —Ä–∞–∑–±—Ä–æ—Å–∞ –µ—ë –∑–Ω–∞—á–µ–Ω–∏–π
# –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ —Å—Ä–µ–¥–Ω–µ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è.

# –î–∏—Å–ø–µ—Ä—Å–∏–µ–π —Å–ª—É—á–∞–π–Ω–æ–π –≤–µ–ª–∏—á–∏–Ω—ã –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è –≤–µ–ª–∏—á–∏–Ω–∞ DŒæ = M(Œæ‚àí MŒæ)^2.
# –í–µ–ª–∏—á–∏–Ω–∞ œÉ = ‚àöDŒæ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è —Å—Ä–µ–¥–Ω–µ–∫–≤–∞–¥—Ä–∞—Ç–∏—á–µ—Å–∫–∏–º –∏–ª–∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç-
# –Ω—ã–º –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ–º.

# –î–ª—è –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω—ã—Ö —Å–ª—É—á–∞–π–Ω—ã—Ö –≤–µ–ª–∏—á–∏–Ω
#     +‚àû
# DŒæ = ‚à´(x ‚àí MŒæ)^2*f(x)dx. 
#     ‚àí‚àû

# –î–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏–∏ –¥–∏—Å–ø–µ—Ä—Å–∏–∏ –º–æ–∂–Ω–æ –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è —Ñ–æ—Ä–º—É–ª–æ–π:
# DŒæ = MŒæ^2 ‚àí (MŒæ)^2

# –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –æ–∂–∏–¥–∞–Ω–∏–µ–º –∏–ª–∏ —Å—Ä–µ–¥–Ω–∏–º –∑–Ω–∞—á–µ–Ω–∏–µ–º —Å–ª—É—á–∞–π–Ω–æ–π –≤–µ–ª–∏—á–∏–Ω—ã Œæ, 
# –∑–∞–¥–∞–Ω–Ω–æ–π –Ω–∞ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–Ω–æ–π –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ (‚Ñ¶, F, P), –Ω–∞–∑—ã–≤–∞-
# –µ—Ç—Å—è —á–∏—Å–ª–æ
#      ‚àû
# MŒæ = ‚à´xdF(x)
#     ‚àí‚àû

# –≥–¥–µ F (x) - —Ñ—É–Ω–∫—Ü–∏—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è Œæ. –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–∂–∏–¥–∞–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –µ—Å–ª–∏
# M|Œæ| < ‚àû.

# –ï—Å–ª–∏ Œæ - –∞–±—Å–æ–ª—é—Ç–Ω–æ –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–∞—è —Å–ª—É—á–∞–π–Ω–∞—è –≤–µ–ª–∏—á–∏–Ω–∞, –∏–º–µ—é—â–∞—è –ø–ª–æ—Ç–Ω–æ—Å—Ç—å f (x),
#       ‚àû
# MŒæ = ‚à´x*f(x)dx.
#      ‚àí‚àû   

# –í –æ–¥–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –ø–æ—Å—Ç—Ä–æ–∏—Ç—å –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º—É –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã—Ö —á–∞—Å—Ç–æ—Ç –∏ –≥—Ä–∞—Ñ–∏–∫
# —Ñ—É–Ω–∫—Ü–∏–∏ –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è, –∏–º–µ—é—â–µ–≥–æ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã a‚àó –∏ (œÉ2)‚àó

# –†–∞–∑–¥–µ–ª–∏–º –æ–±–ª–∞—Å—Ç—å –≤—ã–±–æ—Ä–æ—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –Ω–∞ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã ‚àÜ1, ‚àÜ2, . . . , ‚àÜm. –û–±–æ–∑–Ω–∞—á–∏–º –∑–∞
# n‚àój (j = 1, 2, . . . , m) —á–∏—Å–ª–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤—ã–±–æ—Ä–∫–∏, –ø–æ–ø–∞–≤—à–∏—Ö –≤ –∏–Ω—Ç–µ—Ä–≤–∞–ª ‚àÜj .
# –ù–∞ –∫–∞–∂–¥–æ–º –∏–∑ –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–≤ ‚àÜj —Å—Ç—Ä–æ–∏–º –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫, –ø–ª–æ—â–∞–¥—å –∫–æ—Ç–æ—Ä–æ–≥–æ –ø—Ä–æ–ø–æ—Ä-
# —Ü–∏–æ–Ω–∞–ª—å–Ω–∞ n‚àój. –û–±—â–∞—è –ø–ª–æ—â–∞–¥—å –≤—Å–µ—Ö –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫–æ–≤ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å —Ä–∞–≤–Ω–∞ –µ–¥–∏–Ω–∏—Ü–µ.
# –ü—É—Å—Ç—å lj - –¥–ª–∏–Ω–∞ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞ ‚àÜj. –í—ã—Å–æ—Ç–∞ hj –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫–∞ –Ω–∞–¥ –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–º ‚àÜj
# —Ä–∞–≤–Ω–∞
# hj = n‚àój/n ¬∑ lj
# –í–µ—Ä—Ö–Ω–∏–π –∫–æ–Ω—Ç—É—Ä –ø–æ–ª—É—á–µ–Ω–Ω–æ–π —Ñ–∏–≥—É—Ä—ã, —Å–æ—Å—Ç–æ—è—â–∏–π –∏–∑ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã—Ö –æ—Ç—Ä–µ–∑–∫–æ–≤
# –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º–æ–π.

# –¢–µ–æ—Ä–µ–º–∞ –æ —Å—Ö–æ–¥–∏–º–æ—Å—Ç–∏:
# –ï—Å–ª–∏ –ø–ª–æ—Ç–Ω–æ—Å—Ç—å —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤—ã–±–æ—Ä–∫–∏ —è–≤–ª—è–µ—Ç—Å—è –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ–π
# —Ñ—É–Ω–∫—Ü–∏–µ–π, —Ç–æ –ø—Ä–∏ –Ω–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–º —É–≤–µ–ª–∏—á–µ–Ω–∏–∏ —á–∏—Å–ª–∞ –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–≤ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏ 
# (m(n) ‚Üí ‚àû, —Ç–∞–∫ —á—Ç–æ m(n)/n ‚Üí 0) –∏–º–µ–µ—Ç –º–µ—Å—Ç–æ —Å—Ö–æ–¥–∏–º–æ—Å—Ç—å –ø–æ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏
# –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º—ã –∫ –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è.

# –¢–µ–æ—Ä–µ–º–∞ –ß–µ–±—ã—à–µ–≤–∞, –°—Ö–æ–¥–∏–º–æ—Å—Ç—å –ø–æ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏:

# –ï—Å–ª–∏ Œæ1, Œæ2, ..., Œæn, ... ‚Äì –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø–æ–ø–∞—Ä–Ω–æ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã—Ö —Å–ª—É—á–∞–π–Ω—ã—Ö –≤–µ–ª–∏—á–∏–Ω, 
# –∏–º–µ—é—â–∏—Ö –∫–æ–Ω–µ—á–Ω—ã–µ –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ–∂–∏–¥–∞–Ω–∏—è –∏ –¥–∏—Å–ø–µ—Ä—Å–∏–∏, –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–µ –æ–¥–Ω–æ–π –∏ —Ç–æ–π –∂–µ 
# –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–π DŒæ1 ‚â§ C, DŒæ2 ‚â§ C, ..., DŒæn ‚â§ C,
# —Ç–æ –¥–ª—è –ª—é–±–æ–≥–æ Œµ > 0,

#                n            n
# lim P {‚à£ 1/n *  ‚àë Œæk - 1/n * ‚àë MŒæk ‚à£ < Œµ} = 1
# n‚Üí‚àû            k=1          k=1

# –¢–∞–∫–∞—è —Å—Ö–æ–¥–∏–º–æ—Å—Ç—å –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Å–ª—É—á–∞–π–Ω—ã—Ö –≤–µ–ª–∏—á–∏–Ω –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è —Å—Ö–æ–¥–∏–º–æ—Å—Ç—å—é
# –ø–æ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏.

# –°—Ä–∞–≤–Ω–∏–≤–∞—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–Ω—É—é –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º—É –∏–ª–∏ –ø–æ–ª–∏–≥–æ–Ω —Å –≥—Ä–∞—Ñ–∏–∫–∞–º–∏ –∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –ø–ª–æ—Ç-
# –Ω–æ—Å—Ç–µ–π, –ø–æ–ª—É—á–∞—é—Ç –ø–µ—Ä–≤—É—é —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω—É—é –æ—Ü–µ–Ω–∫—É –¥–ª—è –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ–π f (x). –ù–∞–ø—Ä–∏-
# –º–µ—Ä, –º–æ–∂–Ω–æ –≤—ã–¥–≤–∏–Ω—É—Ç—å –≥–∏–ø–æ—Ç–µ–∑—É –æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º –∑–∞–∫–æ–Ω–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Å–ª—É—á–∞–π–Ω–æ–π –≤–µ-
# –ª–∏—á–∏–Ω—ã.


freq_and_density_hists <- function(vec, exp_val, number) {
  
  # sd (œÉ) - —Å—Ä–µ–¥–Ω–µ–∫–≤–∞–¥—Ä–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤, —Ä–∞–≤–Ω–æ –∫–æ—Ä–Ω—é –∏–∑ –¥–∏—Å–ø–µ—Ä—Å–∏–∏.
  x <- seq(exp_val - 5 * sd(vec), exp_val + 5 * sd(vec), length.out = 200)
  
  # –§—É–Ω–∫—Ü–∏—è –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
  # dnorm –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –ø—Ä–∏ –∑–∞–¥–∞–Ω–Ω–æ–π —Å–ª—É—á–∞–π–Ω–æ–π –≤–µ–ª–∏—á–∏–Ω–µ
  # —Å—Ä–µ–¥–Ω–µ–º –∑–Ω–∞—á–µ–Ω–∏–∏ –∏ —Å—Ä–µ–¥. –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–∏.
  f_1 <- dnorm(x, exp_val, sd(vec))
  
  # –ü—Ä–∞–≤–∏–ª–æ –°—Ç—ë—Ä–¥–∂–µ—Å–∞
  columns_num <- 1 + round(log2(length(vec)))

  # ylim - –∑–∞–¥–∞—ë–º –æ–±—â—É—é –≤—ã—Å–æ—Ç—É –≥—Ä–∞—Ñ–∏–∫–∞, –æ–Ω–∞ –±—É–¥–µ—Ç —Ä–∞–≤–Ω–∞ 2 –æ—Ç –≤—ã—Å–æ—Ç—ã –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ —Å—Ç–æ–ª–±—Ü–∞
  hist(vec, breaks=seq(min(vec), max(vec), length.out = columns_num), freq = FALSE, xlim = range(x), 
       ylim = c(0, 2 * max(f_1)), col = "coral1", main = sprintf("–ì–∏—Å—Ç–æ–≥—Ä–∞–º–º—ã –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã—Ö —á–∞—Å—Ç–æ—Ç –¥–ª—è –≤—ã–±–æ—Ä–∫–∏ –∏–∑ %d —ç–ª–µ–º–µ–Ω—Ç–æ–≤", length(vec)),
       xlab = "x", ylab = "h_i")
  
  lines(x, f_1, lwd = 2, col = "coral4")
  
  # –õ–µ–≥–µ–Ω–¥–∞
  legend("topright", c("–ì–∏—Å—Ç–æ–≥—Ä–∞–º–º–∞ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã—Ö —á–∞—Å—Ç–æ—Ç",
                       "–ì—Ä–∞—Ñ–∏–∫ —Ñ—É–Ω–∫—Ü–∏–∏ –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏"),
         col=c("coral1", "coral4"), lwd = 5, cex = 0.8, box.lty = 0)
}

freq_and_density_hists(df1$x, exp_val_1, 1)
freq_and_density_hists(df2$x, exp_val_2, 2)
freq_and_density_hists(df3$x, exp_val_3, 3)

# –í –æ–¥–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –ø–æ—Å—Ç—Ä–æ–∏—Ç—å –≥—Ä–∞—Ñ–∏–∫–∏ —ç–º–ø–∏—Ä–∏—á–µ—Å–∫–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
# –∏ —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è (—Ç.–µ. —Ñ—É–Ω–∫—Ü–∏–∏ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
# —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ a‚àó –∏ (œÉ2)‚àó)

# –¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∞—è —Ñ—É–Ω–∫—Ü–∏—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è - –Ω–∞—à–∞ –∏—Å—Ö–æ–¥–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è.

# –ï—Å–ª–∏ —ç–ª–µ–º–µ–Ω—Ç—ã –≤—ã–±–æ—Ä–∫–∏ x —É–ø–æ—Ä—è–¥–æ—á–∏—Ç—å –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é, —Ç–æ –ø–æ–ª—É—á–∏—Ç—Å—è –ø–æ—Å–ª–µ–¥–æ–≤–∞-
# —Ç–µ–ª—å–Ω–æ—Å—Ç—å x(1) ‚â§ x(2) ‚â§ ¬∑ ¬∑ ¬∑ ‚â§ x(n), –∫–æ—Ç–æ—Ä–∞—è –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è –≤–∞—Ä–∏–∞—Ü–∏–æ–Ω–Ω—ã–º —Ä—è–¥–æ–º.
# –í–µ–ª–∏—á–∏–Ω–∞ x(n) ‚àí x(1) –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è —Ä–∞–∑–º–∞—Ö–æ–º –≤—ã–±–æ—Ä–∫–∏.
# –ü–æ –Ω–µ–º—É –º–æ–∂–Ω–æ –ø–æ—Å—Ç—Ä–æ–∏—Ç—å —ç–º–ø–∏—Ä–∏—á–µ—Å–∫—É—é —Ñ—É–Ω–∫—Ü–∏—é —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è:
#         {0, y ‚â§ x(1),
# Fn(y) = {m/n, x(m) < y ‚â§ x(m+1),
#         {1, y > x(n)

# –í –æ—Ç–ª–∏—á–∏–µ –æ—Ç —Ç–µ–æ—Ä. —Ñ—É–Ω–∫—Ü–∏–∏, —ç–º–ø–∏—Ä–∏—á–µ—Å–∫–∞—è —Ñ—É–Ω–∫—Ü–∏—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
# —è–≤–ª—è–µ—Ç—Å—è —Å–ª—É—á–∞–π–Ω–æ–π –≤–µ–ª–∏—á–∏–Ω–æ–π. –î–ª—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –≤—ã–±–æ—Ä–æ–∫ –æ–Ω–∞ –ø–æ–ª—É—á–∞–µ—Ç—Å—è —Ä–∞–∑–Ω–æ–π.

# –ü—Ä–∏ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏–∏ –æ–±—ä—ë–º–∞ –≤—ã–±–æ—Ä–∫–∏ —ç–º–ø–∏—Ä–∏—á–µ—Å–∫–∞—è —Ñ—É–Ω–∫—Ü–∏—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –Ω–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ
# –ø—Ä–∏–±–ª–∏–∂–∞–µ—Ç—Å—è –∫ —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∏—Å—Ö–æ–¥–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è F.
# –î–ª—è —ç–º–ø–∏—Ä–∏—á–µ—Å–∫–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π –º–æ–∂–Ω–æ –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–µ –∂–µ –º–µ—Ç–æ–¥—ã, —á—Ç–æ –∏ –¥–ª—è —Ç–µ–æ—Ä.

# –¢–µ–æ—Ä–µ–º—ã –æ —Å—Ö–æ–¥–∏–º–æ—Å—Ç–∏:
#       P
# Fn(y) ‚Üí F(y) –ø—Ä–∏ n ‚Üí ‚àû.

# –ì–ª–∏–≤–µ–Ω–∫–æ-–ö–∞–Ω—Ç–µ–ª–ª–∏
#                   P
# sup|Fk(y) ‚àí F(y)| ‚Üí 0 –ø—Ä–∏ n ‚Üí ‚àû
# y‚ààR

build_graphics <- function(vec, exp_val, number) {
  x <- seq(exp_val - 5 * sd(vec), exp_val + 5 * sd(vec), length.out = 200)
  
  # pnorm - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
  theory_func <- pnorm(x, mean=exp_val, sd=sd(vec))
  
  # ecdf - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —ç–º–ø–∏—Ä–∏—á–µ—Å–∫—É—é —Ñ—É–Ω–∫—Ü–∏—é —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
  empiric_func <- ecdf(sort(vec))
  
  # –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
  plot(x, theory_func, xlim = range(x), ylim = c(0, max(theory_func)),
       main = sprintf("–§—É–Ω–∫—Ü–∏–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –¥–ª—è –≤—ã–±–æ—Ä–∫–∏ –∏–∑ %d —ç–ª–µ–º–µ–Ω—Ç–æ–≤", length(vec)),
       xlab = "x", ylab = "F(x)", col = "darkslategray3", type = "l", lwd = 6)
  
  lines(seq(-20, min(x), length.out = 200), seq(0, 0, length.out = 200), 
        col = "darkslategray3", lwd = 6)
  
  lines(seq(max(x), 30, length.out = 200), seq(1, 1, length.out = 200), 
        col = "darkslategray3", lwd = 6)
  
  # –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ —ç–º–ø–∏—Ä–∏—á–µ—Å–∫–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
  lines(empiric_func, lwd = 3, col = "darkslategray")
  
  lines(seq(-20, min(vec), length.out = 200), seq(0, 0, length.out = 200), 
        col = "darkslategray", lwd = 3)
  
  lines(seq(max(vec), 30, length.out = 200), seq(1, 1, length.out = 200),
        col = "darkslategray", lwd = 3)
  
  legend("bottomright", c("–≠–º–ø–∏—Ä–∏—á–µ—Å–∫–∞—è —Ñ—É–Ω–∫—Ü–∏—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è", 
                          "–¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∞—è —Ñ—É–Ω–∫—Ü–∏—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è"), 
         col = c("darkslategray", "darkslategray3"), lwd = 4, cex = 0.8, box.lty = 0)
}

build_graphics(df1$x, mn_1, 1)
build_graphics(df2$x, mn_2, 2)
build_graphics(df3$x, mn_3, 3)

#===========================================================
#                          –†–∞—Å—á—ë—Ç—ã
# –î–ª—è —Ç. x=-2:


count <- 0

for (number in df1$x) {
  if (number < -2) {
    count <- count + 1
  }
}

count/length(df1$x)

count <- 0

for (number in df2$x) {
  if (number < -2) {
    count <- count + 1
  }
}

count/length(df2$x)

count <- 0

for (number in df3$x) {
  if (number < -2) {
    count <- count + 1
  }
}

count/length(df3$x)

count <- 0

# –õ–ò–ë–û

empiric_func <- ecdf(sort(df1$x))
empiric_func(-2)
empiric_func(-1.5)

empiric_func <- ecdf(sort(df2$x))
empiric_func(-2)
empiric_func(-1.5)

empiric_func <- ecdf(sort(df3$x))
empiric_func(-2)
empiric_func(-1.5)

# –¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∞—è —Ñ—É–Ω–∫—Ü–∏—è:

theory_func <- pnorm(-2, mean=mn_1, sd=sd(df1$x))
theory_func

theory_func <- pnorm(-1.5, mean=mn_1, sd=sd(df1$x))
theory_func

# –î–ª—è x=-1,5

count <- 0

for (number in df1$x) {
  if (number < -1.5) {
    count <- count + 1
  }
}

count/length(df1$x)

count <- 0

for (number in df2$x) {
  if (number < -1.5) {
    count <- count + 1
  }
}

count/length(df2$x)

count <- 0

for (number in df3$x) {
  if (number < -1.5) {
    count <- count + 1
  }
}

count/length(df3$x)

count <- 0


#===========================================================

# –ó–∞–¥–∞–Ω–∏–µ 3
# –°—Ä–∞–≤–Ω–∏—Ç—å –ø–æ–ª—É—á–∏–≤—à–∏–µ—Å—è –≥—Ä–∞—Ñ–∏–∫–∏ –¥–ª—è —Ç—Ä–µ—Ö –≤—ã–±–æ—Ä–æ–∫ –∏ –æ–±–æ—Å–Ω–æ–≤–∞—Ç—å –Ω–∞ –∏—Ö
# –ø—Ä–∏–º–µ—Ä–µ —Å–ø—Ä–∞–≤–µ–¥–ª–∏–≤–æ—Å—Ç—å —Ç–µ–æ—Ä–µ–º
# - –ü—Ä–∏ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –±–æ–ª—å—à–∏—Ö –∑–Ω–∞—á–µ–Ω–∏—è—Ö n —ç–º–ø–∏—Ä–∏—á–µ—Å–∫–∞—è —Ñ—É–Ω–∫—Ü–∏—è —Å—Ç—Ä–µ–º–∏—Ç—Å—è –∫ —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–æ–π.
# - –ü–æ –≥—Ä–∞—Ñ–∏–∫–∞–º –≤–∏–¥–Ω–æ, —á—Ç–æ –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º–∞ —Å—Ç—Ä–µ–º–∏—Ç—Å—è –∫ —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ 
#   –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏ –ø—Ä–∏ —á–∏—Å–ª–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–≤, –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–º –ø–æ —Ñ–æ—Ä–º—É–ª–µ –°—Ç–∏—Ä–ª–∏–Ω–≥–∞.

# –ó–∞–¥–∞–Ω–∏–µ 4

# –î–ª—è –≤—Å–µ—Ö —Ç—Ä–µ—Ö –≤—ã–±–æ—Ä–æ–∫ –Ω–∞–π—Ç–∏ –¥–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã –¥–ª—è –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–∂–∏–¥–∞–Ω–∏—è
# –∏ –¥–∏—Å–ø–µ—Ä—Å–∏–∏ —É—Ä–æ–≤–Ω—è –¥–æ–≤–µ—Ä–∏—è q = 0.95

# –î–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª - —ç—Ç–æ –¥–æ–ø—É—Å—Ç–∏–º–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –Ω–∞–±–ª—é–¥–∞–µ–º—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
# –æ—Ç –∏—Å—Ç–∏–Ω–Ω—ã—Ö. –î–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤ –∫–∞–∫–æ–º –¥–∏–∞–ø–∞–∑–æ–Ω–µ —Ä–∞—Å–ø–æ–ª–æ–∂–∞—Ç—Å—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
# –≤—ã–±–æ—Ä–æ—á–Ω—ã—Ö –Ω–∞–±–ª—é–¥–µ–Ω–∏–π.
# –î–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª - —ç—Ç–æ –∏–Ω—Ç–µ—Ä–≤–∞–ª –∑–Ω–∞—á–µ–Ω–∏–π –∏–∑—É—á–∞–µ–º–æ–≥–æ –ø—Ä–∏–∑–Ω–∞–∫–∞, –≤ –∫–æ—Ç–æ—Ä–æ–º —Å —Ç–æ–π
# –∏–ª–∏ –∏–Ω–æ–π –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å—é –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –∑–Ω–∞—á–µ–Ω–∏–µ –≥–µ–Ω–µ—Ä–∞–ª—å–Ω–æ–≥–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞.

# –î–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω—ã–º –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–º –¥–ª—è –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ ùúÉ —É—Ä–æ–≤–Ω—è –¥–æ–≤–µ—Ä–∏—è 1 -ùúÄ (–∏–ª–∏ —É—Ä–æ–≤–Ω—è
# –∑–Ω–∞—á–∏–º–æ—Å—Ç–∏ ùúÄ), –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è –∏–Ω—Ç–µ—Ä–≤–∞–ª (ùúÉ1, ùúÉ2)
# , —Ç–∞–∫–æ–π, —á—Ç–æ
# P(ùúÉ1< ùúÉ < ùúÉ2) ‚â• 1 ‚àí ùúÄ

# –ò–Ω—Ç–µ—Ä–≤–∞–ª (ùúÉ1, ùúÉ2) –Ω–∞–∫—Ä—ã–≤–∞–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä ùúÉ
# –ò–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω–æ—Å—Ç—å –æ—Ü–µ–Ω–∫–∏: –¥–ª–∏–Ω–∞ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞
# –¢–æ—á–Ω–æ—Å—Ç—å –æ—Ü–µ–Ω–∫–∏: —É—Ä–æ–≤–µ–Ω—å –¥–æ–≤–µ—Ä–∏—è

find_inteval_for_a <- function(v, s_02, mn, q) {
  
  a <- 1 - q # –ü–∞—Ä–∞–º–µ—Ç—Ä –Ω–æ—Ä–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
  t <- qt(1 - a/2, length(v) - 1) # –ö–≤–∞–Ω—Ç–∏–ª—å —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –°—Ç—å—é–¥–µ–Ω—Ç–∞
  
  min_val <- mn - t * sqrt(s_02) / sqrt(length(v))
  max_val <- mn + t * sqrt(s_02) / sqrt(length(v))
  
  return(c(min_val, max_val))
}

interval_for_a_1 <- find_inteval_for_a(df1$x, s0_1, mn_1, 0.95)
interval_for_a_2 <- find_inteval_for_a(df2$x, s0_2, mn_2, 0.95)
interval_for_a_3 <- find_inteval_for_a(df3$x, s0_3, mn_3, 0.95)

find_interval_for_q <- function(v, s_02, q) {
  a <- 1 - q 
  
  # –ö–≤–∞–Ω—Ç–∏–ª—å —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ö–∏-–∫–≤–∞–¥—Ä–∞—Ç —Å df —Å—Ç–µ–ø–µ–Ω—è–º–∏ —Å–≤–æ–±–æ–¥—ã —É—Ä–æ–≤–Ω—è p
  x_1 <- qchisq(1 - a/2, length(v) - 1)
  x_2 <- qchisq(a/2, length(v) - 1)
  
  min_val <- (length(v) - 1) * s_02 / x_1
  max_val <- (length(v) - 1) * s_02 / x_2
  
  return(c(min_val, max_val))
}

interval_for_q_1 <- find_interval_for_q(df1$x, s0_1, 0.95)
interval_for_q_2 <- find_interval_for_q(df2$x, s0_2, 0.95)
interval_for_q_3 <- find_interval_for_q(df3$x, s0_3, 0.95)

# –ó–∞–¥–∞–Ω–∏–µ 5
# –û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ –≤–∑–∞–∏–º–Ω–æ–µ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ —Ç–æ—á–µ—á–Ω—ã—Ö –æ—Ü–µ–Ω–æ–∫ a‚àó –∏ (œÉ2)‚àó –∏ 
# –¥–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–≤ –¥–ª—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ a –∏ œÉ2

# –î–æ–ø—É—Å—Ç–∏–º—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª –¥–ª—è a –Ω–∞–∫—Ä—ã–≤–∞–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä a, –≤—ã—á–∏—Å–ª–µ–Ω–Ω—ã–π –º–µ—Ç–æ–¥–æ–º –º–æ–º–µ–Ω—Ç–æ–≤.
# –î–æ–ø—É—Å—Ç–∏–º—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª –¥–ª—è œÉ –Ω–∞–∫—Ä—ã–≤–∞–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä œÉ, –≤—ã—á–∏—Å–ª–µ–Ω–Ω—ã–π –º–µ—Ç–æ–¥–æ–º –º–æ–º–µ–Ω—Ç–æ–≤.

# –ó–∞–¥–∞–Ω–∏—è 6 –∏ 7

# –í –æ–¥–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –ø–æ—Å—Ç—Ä–æ–π—Ç–µ –¥–ª—è –∫–∞–∂–¥–æ–π –∏–∑ –≤—ã–±–æ—Ä–æ–∫ –≥—Ä–∞—Ñ–∏–∫–∏ –∏–∑–º–µ–Ω–µ-
# –Ω–∏—è –¥–ª–∏–Ω—ã –¥–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω–æ–≥–æ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞ –¥–ª—è a –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —É—Ä–æ–≤–Ω—è –¥–æ–≤–µ—Ä–∏—è q
# –æ—Ç 0.9 –¥–æ 0.99999 —Å –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–µ–ª–∫–∏–º —à–∞–≥–æ–º (—Ç.–µ. —Ä–∞–∑–¥–µ–ª–∏–≤ –∏–Ω—Ç–µ—Ä–≤–∞–ª –∏–∑–º–µ–Ω–µ–Ω–∏—è
# q –Ω–µ –º–µ–Ω–µ–µ, —á–µ–º –Ω–∞ 100 —á–∞—Å—Ç–µ–π)

# –í –æ–¥–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –ø–æ—Å—Ç—Ä–æ–π—Ç–µ –¥–ª—è –∫–∞–∂–¥–æ–π –∏–∑ –≤—ã–±–æ—Ä–æ–∫ –≥—Ä–∞—Ñ–∏–∫–∏ –∏–∑–º–µ–Ω–µ-
# –Ω–∏—è –¥–ª–∏–Ω—ã –¥–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω–æ–≥–æ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞ –¥–ª—è œÉ2 –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —É—Ä–æ–≤–Ω—è –¥–æ–≤–µ—Ä–∏—è q
# –æ—Ç 0.9 –¥–æ 0.99999 —Å –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–µ–ª–∫–∏–º —à–∞–≥–æ–º (—Ç.–µ. —Ä–∞–∑–¥–µ–ª–∏–≤ –∏–Ω—Ç–µ—Ä–≤–∞–ª –∏–∑–º–µ–Ω–µ–Ω–∏—è
# q –Ω–µ –º–µ–Ω–µ–µ, —á–µ–º –Ω–∞ 100 —á–∞—Å—Ç–µ–π)

interval_len_for_a_1 <- c()
interval_len_for_q_1 <- c()

interval_len_for_a_2 <- c()
interval_len_for_q_2 <- c()

interval_len_for_a_3 <- c()
interval_len_for_q_3 <- c()

trust_levels <- seq(0.9, 0.99999, 0.09999 / 100)

for (t_lev in trust_levels) {
  interval_for_a <- find_inteval_for_a(df1$x, s0_1, mn_1, t_lev)
  interval_len_for_a_1 <- c(interval_len_for_a_1, interval_for_a[2] - interval_for_a[1])
  
  interval_for_q <- find_interval_for_q(df1$x, s0_1, t_lev)
  interval_len_for_q_1 <- c(interval_len_for_q_1, interval_for_q[2] - interval_for_q[1])
  
  
  interval_for_a <- find_inteval_for_a(df2$x, s0_2, mn_2, t_lev)
  interval_len_for_a_2 <- c(interval_len_for_a_2, interval_for_a[2] - interval_for_a[1])
  
  interval_for_q <- find_interval_for_q(df2$x, s0_2, t_lev)
  interval_len_for_q_2 <- c(interval_len_for_q_2, interval_for_q[2] - interval_for_q[1])
  
  
  interval_for_a <- find_inteval_for_a(df3$x, s0_3, mn_3, t_lev)
  interval_len_for_a_3 <- c(interval_len_for_a_3, interval_for_a[2] - interval_for_a[1])
  
  interval_for_q <- find_interval_for_q(df3$x, s0_3, t_lev)
  interval_len_for_q_3 <- c(interval_len_for_q_3, interval_for_q[2] - interval_for_q[1])
}

# –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–æ–≤ –∏–∑–º–µ–Ω–µ–Ω–∏—è –¥–ª–∏–Ω—ã –¥–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–≤

plot(trust_levels, interval_len_for_a_1, col = "tan1", ylab = "length",
     main = "–î–ª–∏–Ω—ã –¥–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–≤ –∞ –¥–ª—è –≤—ã–±–æ—Ä–æ–∫", xlim = c(0.9, 0.99999), 
     ylim = c(0, max(interval_len_for_a_1)), lwd = 2, type = "l")

lines(trust_levels, interval_len_for_a_2, col = "wheat3", lwd = 2)

lines(trust_levels, interval_len_for_a_3, col = "seagreen3", lwd = 2)

legend("topleft", c("–î–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã –¥–ª—è 10 —ç–ª–µ–º–µ–Ω—Ç–æ–≤", 
                    "–î–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã –¥–ª—è 50 —ç–ª–µ–º–µ–Ω—Ç–æ–≤", 
                    "–î–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã –¥–ª—è 170 —ç–ª–µ–º–µ–Ω—Ç–æ–≤"), 
       col=c("tan1", "wheat3", "seagreen3"), lwd=2, cex=0.8)


plot(trust_levels, interval_len_for_q_1, col="red3", ylab="length",
     main="–î–ª–∏–Ω—ã –¥–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–≤ œÉ2 –¥–ª—è –≤—ã–±–æ—Ä–æ–∫", xlim=c(0.9, 0.99999), 
     ylim=c(0, max(interval_len_for_q_1)), lwd=2, type="l")

lines(trust_levels, interval_len_for_q_2, col="yellow2", lwd = 2)

lines(trust_levels, interval_len_for_q_3, col="steelblue3", lwd = 2)

legend("topleft", c("–î–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã –¥–ª—è 10 —ç–ª–µ–º–µ–Ω—Ç–æ–≤", 
                    "–î–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã –¥–ª—è 50 —ç–ª–µ–º–µ–Ω—Ç–æ–≤", 
                    "–î–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã –¥–ª—è 170 —ç–ª–µ–º–µ–Ω—Ç–æ–≤"), 
       col=c("red3", "yellow2", "steelblue3"), lwd=2, cex=0.8)

# –ó–∞–¥–∞–Ω–∏–µ 8
# –û–ø–∏—à–∏—Ç–µ, —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Å –¥–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω—ã–º–∏ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞–º–∏ –¥–ª—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ a –∏ œÉ^2
 
# –ü—Ä–∏ —É–≤–µ–ª–∏—á–µ–Ω–∏–∏ –æ–±—ä—ë–º–∞ –≤—ã–±–æ—Ä–∫–∏ –¥–ª–∏–Ω—ã –¥–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–≤ —É–º–µ–Ω—å—à–∞—é—Ç—Å—è. 
# –≠—Ç–æ –æ–±—ä—è—Å–Ω—è–µ—Ç—Å—è –∑–∞–∫–æ–Ω–æ–º –±–æ–ª—å—à–∏—Ö —á–∏—Å–µ–ª –∏ –≤–∑–∞–∏–º–Ω–æ–π –∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏–µ–π 
# –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–π –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞.
# –ü—Ä–∏ —É–≤–µ–ª–∏—á–µ–Ω–∏–∏ —É—Ä–æ–≤–Ω—è –¥–æ–≤–µ—Ä–∏—è –¥–ª–∏–Ω—ã –¥–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–≤
# —É–≤–µ–ª–∏—á–∏–≤–∞—é—Ç—Å—è. –ü–æ–≤—ã—à–∞–µ—Ç—Å—è –Ω–∞–¥—ë–∂–Ω–æ—Å—Ç—å –æ—Ü–µ–Ω–∫–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞, –Ω–æ –ø–æ–Ω–∏–∂–∞–µ—Ç—Å—è –µ—ë —Ç–æ—á–Ω–æ—Å—Ç—å.

