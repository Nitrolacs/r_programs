source("~/.active-rstudio-document", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
View(bmw_x1_df)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
View(bmw_x1_df)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
library(corrplot)
install.packages("corrplot")
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
plot(model_1)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
bmw_df <- read.csv("bmw.csv")
bmw_x1_df <- subset(bmw_df, bmw_df$model == ' X1' & bmw_df$engineSize != 0.0 & bmw_df$year < 2023)
bmw_table <- table(bmw_x1_df$year, bmw_x1_df$fuelType)
chisq.test(bmw_table)
summary(model_1)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
bmw_df <- read.csv("bmw.csv")
bmw_x1_df <- subset(bmw_df, bmw_df$model == ' X1' & bmw_df$engineSize != 0.0 & bmw_df$year < 2023)
bmw_table <- table(bmw_x1_df$year, bmw_x1_df$fuelType)
View(bmw_table)
bmw_x1_df$year_united <- bmw_x1_df$year
bmw_x1_df$year_united[bmw_x1_df$year %in% seq(2010,2011)] = '2010-2011'
bmw_x1_df$year_united[bmw_x1_df$year %in% seq(2010,2015)] = '2010-2015'
bmw_table <- table(bmw_x1_df$year_united, bmw_x1_df$fuelType)
View(bmw_table)
(bmw_table)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
bmw_df <- read.csv("bmw.csv")
bmw_x1_df <- subset(bmw_df, bmw_df$model == ' X1' & bmw_df$engineSize != 0.0 & bmw_df$year < 2023)
bmw_table <- table(bmw_x1_df$year, bmw_x1_df$fuelType)
View(bmw_table)
bmw_x1_df$year_united <- bmw_x1_df$year
bmw_x1_df$year_united[bmw_x1_df$year %in% seq(2010,2016)] = '2010-2016'
bmw_table <- table(bmw_x1_df$year_united, bmw_x1_df$fuelType)
View(bmw_table)
chisq.test(bmw_table)
freedom_degree <- (2 - 1)
a <- 0.001 # уровень значимости критерия
xcr <- qchisq(p = 1 - a, df = freedom_degree)
xcr
e=residuals(model_1)
qqnorm(e, pch=1)
qqline(e, lty=2)
e=residuals(model_2)
qqnorm(e, pch=1)
qqline(e, lty=2)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
new_years <- c(2017, 2018, 2019, 2020)
new_mpgs <- c(50.0, 60.9, 65.9, 71.2)
new_engineSizes <- c(1.3, 1.5, 1.6,  1.8)
new_taxs <- c(0, 30, 45, 75)
new_mileages <- c(10231, 11243, 12124, 13214)
data_new <- data.frame(year = new_years, mileage = new_mileages, tax = new_taxs,
mpg = new_mpgs, engineSize = new_engineSizes)
price_new <- predict(model_1, data_new)
price_new
data_new2 <- data.frame(year = new_years, mileage = new_mileages, tax = new_taxs,
engineSize = new_engineSizes)
price_new2 <- predict(model_2, data_new2)
price_new2
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
model_1 <- lm(price ~ year + mileage + tax + mpg + engineSize, bmw_x1_df)
corrplot(M, method="color", addCoef.col="purple", number.digits=1, number.cex = 1.3)
model_2 <- lm(price ~ year + tax + mpg + engineSize, bmw_x1_df)
summary(model_2)
data_new <- data.frame(year = new_years, mileage = new_mileages, tax = new_taxs,
mpg = new_mpgs, engineSize = new_engineSizes)
price_new <- predict(model_1, data_new)
price_new
data_new2 <- data.frame(year = new_years, tax = new_taxs, mpg = new_mpgs,
engineSize = new_engineSizes)
price_new2 <- predict(model_2, data_new2)
price_new2
price_new2
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
chisq.test(bmw_table) # X-squared = 149.45
chisq.test(bmw_table) # X-squared = 149.45
summary(model_1)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
source("C:/Users/nikit/Desktop/programming/r_labs/lab3/main.R", echo=TRUE)
summary(model_2)
# Чтобы просмотреть вывод модели регрессии, мы можем использовать команду summary().
summary(model_1)
qqnorm(e, pch=1, col="red", main = "Q-Q график для 1 модели")
qqnorm(e, pch=1, col="red", main = "Q-Q график для 1 модели")
qqline(e, lty=2, col="blue")
new_dataframe <- read.csv("training_data_R.xlsx")
View(new_dataframe)
new_dataframe <- read.xlsx("training_data_R.xlsx")
library xlasx
library(xlsx)
new_dataframe <- read.xlsx("training_data_R.xlsx")
new_dataframe <- read.xlsx("training_data_R.xlsx", sheet=1)
new_dataframe <- read.xlsx("training_data_R.xlsx", sheet="Лист1")
new_dataframe <- read_excel("training_data_R.xlsx", sheet="Лист1")
install.packages("readxl")
new_dataframe <- read_excel("training_data_R.xlsx", sheet="Лист1")
new_dataframe <- read.xslx("training_data_R.xlsx", sheetIndex=1)
library(xlsx)
new_dataframe <- read.xslx("training_data_R.xlsx", sheetIndex=1)
new_dataframe <- read.xlsx("training_data_R.xlsx", sheetIndex=1)
new_dataframe <- read.xlsx("training_data_R.xlsx", sheetIndex=1)
View(new_dataframe)
View(new_dataframe)
new_model <- lm(ln(resistivity) ~ temperature + humidity + density + particle_size, new_dataframe)
new_model <- lm(log(resistivity) ~ temperature + humidity + density + particle_size, new_dataframe)
View(new_model)
summary(new_model)
plot(new_model, col="green", main="График новой модели")
plot(new_model, col="red", main="График новой модели")
new_model <- lm(log(resistivity) ~ temperature + humidity + density + particle_size, new_dataframe)
summary(new_model)
plot(new_model, col="red", main="График новой модели")
View(info_1)
library(corrplot)
M <- cor(new_model)
View(info_1)
View(new_dataframe)
M <- cor(new_dataframe)
M
corrplot(M, method="color", addCoef.col="purple", number.digits=1, number.cex = 1.3,
main="Корреляция между параметрами")
corrplot(M, method="color", addCoef.col="purple", number.digits=1, number.cex = 1.3,
main="Корреляция между параметрами")
corrplot(M, method="color", addCoef.col="purple", number.digits=1, number.cex = 1.3,
main="Корреляция между параметрами")
M <- cor(info_1)
M
corrplot(M, method="color", addCoef.col="purple", number.digits=1, number.cex = 1.3,
main="Корреляция между параметрами")
library(corrplot)
M <- cor(new_dataframe)
M
new_dataframe <- transform(new_dataframe, ln_resistivity=log(resistivity))
View(new_dataframe)
new_model <- lm(ln_resistivity ~ temperature + humidity + density + particle_size, new_dataframe)
summary(new_model)
plot(new_model, col="red", main="График новой модели")
M <- cor(new_dataframe)
new_M <- cor(new_dataframe)
View(new_dataframe)
View(bmw_df)
new_info <- new_dataframe[,c(2,3,4,5,6)]
View(new_info)
new_M <- cor(new_dataframe)
new_M
new_M <- cor(new_info)
new_M
corrplot(new_M, method="color", addCoef.col="purple", number.digits=1, number.cex = 1.3,
main="Корреляция между параметрами")
e=residuals(new_model)
qqnorm(e, pch=1, col="red", main = "Q-Q график для 1 модели")
qqline(e, lty=2, col="blue")
qqline(e, lty=2, col="blue")
legend("bottomright", c("Уравнение регрессии","Реальные значения функции"),
col=c("blue", "red"), lwd=4, cex=0.8, box.lty=0)
new_M <- cor(new_info)
new_M
corrplot(new_M, method="color", addCoef.col="purple", number.digits=1, number.cex = 1.3,
main="Корреляция между параметрами")
corrplot(cor(new_info), method="color", addCoef.col="purple", number.digits=1, number.cex = 1.3,
main="Корреляция между параметрами")
corrplot(cor(new_info), method="color", addCoef.col="purple",
main="Корреляция между параметрами")
new_M <- cor(new_info, use = "complete.obs")
new_M
corrplot(new_M, method="color", addCoef.col="purple", number.digits=1, number.cex = 1.3,
main="Корреляция между параметрами")
corrplot(M, method="color", addCoef.col="purple", number.digits=1, number.cex = 1.3,
main="Корреляция между параметрами")
M <- cor(info_1)
M
corrplot(M, method="color", addCoef.col="purple", number.digits=1, number.cex = 1.3,
main="Корреляция между параметрами")
corrplot(new_M, method="color", addCoef.col="purple", number.digits=1, number.cex = 1.3,
main="Корреляция между параметрами")
new_model_2 <- lm(ln_resistivity ~ humidity + density + particle_size, new_dataframe)
summary(new_model_2)
View(new_dataframe)
new_humidity <- c(1.40, 3.40, 11.80)
new_density <- c(1380, 1183, 1595)
new_particle_size <- c(51.2, 11.64, 9.76)
data_new2 <- data.frame(humidity = new_humidity, density = new_density, particle_size = new_particle_size)
ln_resistivity_new2 <- predict(new_model_2, data_new2)
ln_resistivity_new2
new_dataframe <- read.xlsx("training_data_R.xlsx", sheetIndex=1)
new_dataframe <- transform(new_dataframe, ln_resistivity=log(resistivity))
new_model <- lm(ln_resistivity ~ temperature + humidity + density + particle_size, new_dataframe)
new_dataframe <- transform(new_dataframe, ln_resistivity=log(resistivity))
summary(new_model)
